基于HTML5+CSS+Three.js的魔法学院单人角色扮演游戏完整设定（含实现逻辑）
 
一、核心世界观设定（共5点）
 
1. 世界名称：埃瑟里亚魔法大陆，由中央「星陨之塔魔法学院」、四大元素试炼场（火焰峡谷、冰霜冻土、雷电高原、自然森林）、终局区域「混沌裂隙」构成，无其他额外区域。
2. 背景故事：千年前混沌领主突破位面封印，魔法师们以生命为代价将其压制，星陨之塔成为传承魔法与守护大陆的核心；玩家作为天赋新生，需通过学习咒语、完成试炼、击杀混沌魔兽，最终彻底封印裂隙，成为「大陆守护者」。
3. 阵营设定：仅存在「星陨之塔魔法师」单一阵营，无对立玩家或中立阵营，所有冲突围绕「学院任务-裂隙魔兽」展开，无阵营切换或背叛机制。
4. 核心规则：玩家初始为1级新生，通过「学习咒语→完成任务→击杀魔兽→获取资源→强化自身」循环提升等级，等级、咒语、任务达成特定条件后解锁终局，无其他额外规则。
5. 世界交互逻辑：所有区域采用「无缝衔接」设计，通过Three.js场景切换API实现无加载界面过渡；可交互物体（NPC、书架、宝箱、试炼石碑）设置「距离触发碰撞检测」，玩家靠近（距离≤角色身高1.5倍）时显示「E键交互」提示，点击后执行对应逻辑。
 
二、角色设定（共6点）
 
1. 角色身份：星陨之塔新生，初始无元素专精，1级时可选择「火焰/冰霜/雷电/自然」其中一种专精，选择后永久锁定，不可更改，直接决定后续咒语类型与属性加成方向。
2. 角色属性（共6项，无额外属性）：
- 等级：1-10级，需积累对应经验值（1级→2级需100经验，每升1级经验需求增加50），每级提升所有基础属性10%；
- 生命值：初始100点，每级+20点，自然专精额外加成（每级+5点），最大值=初始值+等级加成+专精加成，无其他额外增益；
- 魔法值：初始80点，每级+15点，雷电专精额外加成（每级+5点），最大值计算规则同生命值；
- 攻击力：初始10点，每级+5点，火焰专精额外加成（每级+3点），直接影响咒语伤害计算；
- 防御力：初始5点，每级+3点，冰霜专精额外加成（每级+2点），直接减免受到的魔兽伤害；
- 施法速度：初始1.0倍，每级+0.1倍，无专精加成，仅通过装备提升，最小值0.5倍（无上限限制但装备加成总和不超过0.5倍）。
3. 角色外观自定义（共4项，无遗漏）：
- 发型：3种固定样式（短发、中长发、长发），无解锁或额外发型，选择后不可更改；
- 发色：6种固定颜色（黑色、棕色、金色、银色、蓝色、紫色），无自定义色值功能，选择后不可更改；
- 服装：初始为「学院基础制服」（无属性加成），8级时解锁对应专精专属法袍（火焰法袍/冰霜法袍/雷电法袍/自然法袍），仅改变外观，无属性影响，切换通过UI面板实现；
- 魔杖：初始为「木质基础魔杖」（无属性加成），5级时解锁对应专精专属魔杖（火焰魔杖/冰霜魔杖/雷电魔杖/自然魔杖），提升对应元素咒语伤害10%，装备后立即生效，不可卸下。
4. 角色动作系统（共8种，无额外动作）：
- 移动：前后左右方向键控制，Three.js通过监听键盘keydown事件更新角色模型position属性，移动速度=基础速度（2m/s）×（1+等级×0.05），无额外加速机制；
- 跳跃：空格键触发，跳跃高度=角色身高×1.5，跳跃过程中禁止施法，Three.js通过修改y轴坐标实现，落地后1秒内不可再次跳跃；
- 物理攻击：鼠标左键触发，非施法状态下生效，伤害=攻击力×0.5，无冷却时间，Three.js通过射线检测判断是否命中目标；
- 咒语施法：鼠标右键触发，需先在UI面板选中已学习咒语，消耗对应魔法值，施法前摇=1-施法速度（最低0.3秒），Three.js播放施法动画并生成咒语粒子模型；
- 物体交互：E键触发，仅对碰撞检测范围内的可交互物体生效，触发后执行对应逻辑（NPC对话/书架学习咒语/宝箱获取物品），交互过程中角色不可移动；
- 闪避：Shift键触发，消耗10点魔法值，向当前移动方向位移=角色身高×2，位移过程中无敌（持续0.5秒），冷却时间5秒，Three.js通过瞬间更新position属性实现；
- 待机动画：角色3秒无任何操作时触发，Three.js播放呼吸动画（模型轻微起伏），有操作时立即停止；
- 受伤动画：生命值减少时触发，Three.js播放后仰动画（模型rotation属性修改），同时通过CSS在屏幕边缘添加红色渐变遮罩，持续0.3秒。
5. 角色状态（共4种，无额外状态）：
- 正常状态：所有属性正常，无增益/减益效果，生命值≥30%时自动处于该状态；
- 受伤状态：生命值＜30%且≥10%时触发，移动速度降低20%，施法速度降低10%，通过修改属性数值实现，生命值恢复至30%以上时自动解除；
- 濒死状态：生命值＜10%时触发，继承受伤状态效果，每2秒恢复5点生命值（自然专精额外+3点），通过定时器setInterval实现，生命值恢复至10%以上时自动解除；
- 无敌状态：仅闪避过程中触发，持续0.5秒，免疫所有伤害，通过设置伤害免疫标记（布尔值）实现，时间结束后标记重置。
6. 角色存档机制：采用localStorage存储所有角色数据，包含等级、经验值、各项属性数值、已学习咒语、装备状态、当前所在场景坐标、已完成/未完成任务列表，无多存档位，仅支持1个存档；关闭浏览器时自动存档，游戏内可通过UI按钮手动存档，读档仅在游戏启动时自动加载，无手动读档功能。
 
三、魔法咒语设定（共4系，每系5个，共20个，无遗漏）
 
（一）火焰专精咒语（5个，按等级解锁）
 
1. 火焰弹（1级解锁）：消耗10点魔法值，伤害=攻击力×1.2，施法前摇0.5秒，无冷却时间；实现逻辑：Three.js创建火焰粒子模型（使用Points类），通过射线检测判断是否命中目标，命中后触发伤害计算函数，同时播放爆炸粒子效果。
2. 火焰喷射（3级解锁）：消耗25点魔法值，向前方喷射火焰，持续2秒，每秒伤害=攻击力×0.8，施法前摇0.8秒，冷却时间8秒；实现逻辑：创建火焰粒子流（使用BufferGeometry生成连续粒子），设置长方体碰撞区域，通过帧监听检测敌方单位是否在区域内，每帧计算持续伤害。
3. 火焰结界（5级解锁）：消耗35点魔法值，自身周围生成火焰结界，持续5秒，敌方进入后每秒受攻击力×0.6伤害，自身火焰伤害提升15%；实现逻辑：创建圆形碰撞区域（半径=角色身高×2），添加火焰粒子环绕效果，区域内友方（仅玩家）添加伤害增益标记，敌方添加持续伤害定时器。
4. 陨石坠落（7级解锁）：消耗50点魔法值，指定区域召唤陨石，造成攻击力×2.5范围伤害，施法前摇1.2秒，冷却时间15秒；实现逻辑：通过鼠标点击获取目标坐标（Three.js射线检测场景地面），创建陨石3D模型并添加下落动画（y轴坐标递减），落地后生成圆形伤害区域（半径=3m），遍历区域内敌方单位计算伤害。
5. 火龙咆哮（9级解锁）：消耗70点魔法值，召唤火龙释放直线范围伤害，伤害=攻击力×3.5，施法前摇1.5秒，冷却时间25秒；实现逻辑：创建火龙半身模型并播放咆哮动画，沿角色朝向生成直线伤害区域（长度=10m，宽度=2m），通过碰撞检测获取区域内所有敌方单位，统一计算伤害并播放雷电粒子效果。
 
（二）冰霜专精咒语（5个，按等级解锁）
 
1. 冰锥术（1级解锁）：消耗10点魔法值，伤害=攻击力×1.1，命中后目标减速20%（持续2秒），施法前摇0.5秒，无冷却时间；实现逻辑：创建冰锥3D模型，通过射线检测命中目标后，为目标添加减速buff（修改移动速度属性），并启动2秒定时器，时间结束后恢复速度。
2. 冰霜护盾（3级解锁）：消耗20点魔法值，生成护盾吸收防御力×3伤害，持续6秒，施法前摇0.6秒，冷却时间10秒；实现逻辑：创建冰霜护盾粒子模型（环绕角色），添加护盾值属性，受到伤害时优先扣除护盾值，护盾值为0或时间结束后，隐藏粒子模型。
3. 冰雾弥漫（5级解锁）：消耗30点魔法值，目标区域生成冰雾（持续4秒），敌方移动速度降低30%、施法速度降低20%，施法前摇0.9秒，冷却时间12秒；实现逻辑：通过鼠标点击确定区域坐标，创建雾效粒子（使用透明度渐变实现朦胧效果），设置圆形碰撞区域，区域内敌方添加减速和减施法速度buff，定时器结束后清除buff和粒子。
4. 冰封术（7级解锁）：消耗45点魔法值，冻结单个目标2秒（BOSS除外），结束后造成攻击力×1.8伤害，施法前摇1.0秒，冷却时间18秒；实现逻辑：射线检测命中目标后，播放冰封动画（模型覆盖冰霜纹理），设置目标不可操作标记（移动、攻击、技能均失效），2秒后清除标记并计算伤害。
5. 冰龙突袭（9级解锁）：消耗65点魔法值，冰龙破土造成直线伤害（攻击力×3.2），30%概率冻结目标1.5秒，施法前摇1.4秒，冷却时间22秒；实现逻辑：创建冰龙模型并播放破土动画，沿角色朝向生成直线伤害区域（长度=8m，宽度=2m），遍历区域内敌方单位计算伤害，通过随机数（0-1）判断是否触发冻结buff（≤0.3时触发）。
 
（三）雷电专精咒语（5个，按等级解锁）
 
1. 雷击术（1级解锁）：消耗10点魔法值，伤害=攻击力×1.3，50%概率暴击（伤害×1.5），施法前摇0.4秒，无冷却时间；实现逻辑：创建雷电粒子模型（从天空指向目标），通过随机数（0-1）判断是否暴击（≤0.5时触发），暴击时增强粒子效果并按暴击伤害计算。
2. 雷电连锁（3级解锁）：消耗25点魔法值，攻击目标后连锁3个敌方单位，首个目标伤害=攻击力×1.2，后续递减20%，施法前摇0.7秒，冷却时间7秒；实现逻辑：射线检测命中首个目标后，通过距离排序获取目标周围3个敌方单位，依次生成雷电粒子连接各目标，按顺序计算递减伤害。
3. 静电场（5级解锁）：消耗30点魔法值，自身周围生成静电场（持续5秒），敌方进入后麻痹0.5秒，自身施法速度提升10%，施法前摇0.8秒，冷却时间11秒；实现逻辑：创建圆形碰撞区域（半径=2.5m），添加静电粒子效果，敌方进入区域时触发麻痹（不可移动0.5秒），自身添加施法速度增益buff，时间结束后清除所有效果。
4. 雷暴降临（7级解锁）：消耗55点魔法值，目标区域召唤雷暴（持续3秒），每秒3道雷电（每道伤害=攻击力×1.0），施法前摇1.1秒，冷却时间16秒；实现逻辑：确定目标区域后，创建雷暴云层粒子模型，每秒通过随机数生成3个区域内随机坐标，生成雷电粒子并检测是否命中敌方，命中后计算伤害。
5. 雷神之怒（9级解锁）：消耗75点魔法值，全屏伤害=攻击力×2.8，40%概率麻痹目标1秒，施法前摇1.6秒，冷却时间30秒；实现逻辑：创建全屏雷电粒子效果（覆盖整个场景），遍历所有敌方单位计算伤害，通过随机数（0-1）判断是否触发麻痹（≤0.4时触发），麻痹期间目标不可移动。
 
（四）自然专精咒语（5个，按等级解锁）
 
1. 藤蔓缠绕（1级解锁）：消耗10点魔法值，束缚目标1.5秒（不可移动），期间持续伤害=攻击力×0.9，施法前摇0.6秒，无冷却时间；实现逻辑：创建藤蔓模型缠绕目标，设置不可移动标记，启动1.5秒定时器，每0.5秒计算一次持续伤害，时间结束后隐藏藤蔓模型并清除标记。
2. 生命汲取（3级解锁）：消耗20点魔法值，伤害=攻击力×1.0，50%伤害转化为自身生命值，施法前摇0.7秒，冷却时间9秒；实现逻辑：射线检测命中目标后计算伤害，将伤害×0.5作为恢复量，更新自身生命值（不超过最大值），同时播放绿色粒子流（从目标指向角色）。
3. 自然祝福（5级解锁）：消耗35点魔法值，自身每秒恢复5点生命值（持续8秒），防御力提升10%，施法前摇0.8秒，冷却时间14秒；实现逻辑：播放绿叶粒子环绕动画，添加生命恢复buff（每1秒通过定时器增加生命值）和防御力增益buff，8秒后清除buff和粒子。
4. 丛林召唤（7级解锁）：消耗50点魔法值，召唤3株食人花（持续6秒），每株每秒攻击周围敌方（伤害=攻击力×0.7），施法前摇1.2秒，冷却时间17秒；实现逻辑：在角色周围随机生成3个坐标（距离角色≥1m），创建食人花3D模型，每1秒触发一次攻击动画，通过碰撞检测攻击周围敌方，6秒后隐藏模型。
5. 自然之怒（9级解锁）：消耗65点魔法值，召唤巨型藤蔓攻击全屏敌方，伤害=攻击力×3.0，自身恢复最大生命值20%，施法前摇1.5秒，冷却时间28秒；实现逻辑：创建巨型藤蔓从地面突起的动画（覆盖全屏），遍历所有敌方单位计算伤害，同时将自身生命值更新为当前值+最大生命值×0.2（不超过最大值），播放绿色恢复粒子效果。
 
四、魔兽设定（共3类，15种，无遗漏）
 
（一）普通魔兽（6种，分布于元素试炼场）
 
1. 火焰幼兽（火焰峡谷）：等级2，生命值80，攻击力12，防御力3，无技能，掉落：火焰结晶（用于学习火焰咒语），掉落概率100%；实现逻辑：Three.js创建小型火焰兽模型，AI采用「直线追击玩家」（距离≤10m时触发），攻击间隔2秒，通过碰撞检测判断是否命中玩家。
2. 冰霜蠕虫（冰霜冻土）：等级2，生命值90，攻击力11，防御力4，无技能，掉落：冰霜结晶（用于学习冰霜咒语），掉落概率100%；实现逻辑：创建蠕虫模型，AI为「潜伏-突袭」（玩家靠近≤5m时冲出攻击），攻击间隔2.5秒，命中后无额外效果。
3. 雷电蝙蝠（雷电高原）：等级2，生命值70，攻击力13，防御力2，无技能，掉落：雷电结晶（用于学习雷电咒语），掉落概率100%；实现逻辑：创建蝙蝠模型，AI为「空中盘旋-俯冲攻击」，攻击间隔1.8秒，移动速度比其他普通魔兽快20%。
4. 藤蔓怪（自然森林）：等级2，生命值85，攻击力10，防御力3，无技能，掉落：自然结晶（用于学习自然咒语），掉落概率100%；实现逻辑：创建藤蔓缠绕的怪物模型，AI为「缓慢追击-近距离攻击」，攻击间隔2.2秒，移动速度比其他普通魔兽慢10%。
5. 混沌仆从（混沌裂隙外围）：等级4，生命值150，攻击力20，防御力6，无技能，掉落：混沌碎片（用于强化装备），掉落概率100%；实现逻辑：创建黑色雾气包裹的人形模型，AI为「持续追击-高频攻击」，攻击间隔1.5秒，移动速度与玩家基础速度一致。
6. 暗影甲虫（混沌裂隙外围）：等级4，生命值130，攻击力22，防御力5，无技能，掉落：混沌碎片，掉落概率100%；实现逻辑：创建甲虫模型，AI为「集群追击」（最多3只同时追击），攻击间隔1.6秒，命中后无额外效果。
 
（二）精英魔兽（4种，分布于元素试炼场深处）
 
1. 火焰领主（火焰峡谷深处）：等级6，生命值300，攻击力40，防御力15，技能：火焰冲击（每5秒释放，造成攻击力×1.5范围伤害），掉落：高级火焰结晶+混沌碎片×2，掉落概率100%；实现逻辑：创建大型火焰人形模型，AI为「远距离火球攻击+近距离冲击」，技能释放时播放火焰爆炸粒子，设置范围伤害区域。
2. 冰霜女王（冰霜冻土深处）：等级6，生命值320，攻击力38，防御力18，技能：冰霜冻结（每6秒释放，冻结玩家1秒），掉落：高级冰霜结晶+混沌碎片×2，掉落概率100%；实现逻辑：创建冰晶女王模型，AI为「冰锥远程攻击+技能冻结」，技能释放时播放冰封粒子，命中玩家后触发冻结状态。
3. 雷电使者（雷电高原深处）：等级6，生命值280，攻击力45，防御力12，技能：雷电连锁（每4秒释放，连锁2个目标），掉落：高级雷电结晶+混沌碎片×2，掉落概率100%；实现逻辑：创建雷电环绕的人形模型，AI为「高频雷击+技能连锁」，技能释放时生成雷电粒子连接玩家与周围魔兽（无其他魔兽时仅攻击玩家）。
4. 自然守护者（自然森林深处）：等级6，生命值350，攻击力35，防御力16，技能：生命恢复（每7秒恢复自身50点生命值），掉落：高级自然结晶+混沌碎片×2，掉落概率100%；实现逻辑：创建绿叶覆盖的人形模型，AI为「藤蔓束缚+近距离攻击」，技能释放时播放绿色粒子效果，更新自身生命值。
 
（三）BOSS魔兽（5种，分布于混沌裂隙核心）
 
1. 混沌骑士（混沌裂隙核心1层）：等级8，生命值800，攻击力70，防御力30，技能：混沌斩（每3秒释放，直线范围伤害）、防御光环（自身防御力提升20%），掉落：混沌核心×1+混沌碎片×5，掉落概率100%；实现逻辑：创建黑色铠甲骑士模型，AI为「冲锋攻击+技能循环」，防御光环持续生效（初始添加防御力加成），混沌斩释放时生成黑色剑气粒子。
2. 暗影法师（混沌裂隙核心1层）：等级8，生命值750，攻击力75，防御力25，技能：暗影弹（每2秒释放3枚）、暗影护盾（吸收200点伤害），掉落：混沌核心×1+混沌碎片×5，掉落概率100%；实现逻辑：创建暗影法师模型，AI为「远程暗影弹攻击+护盾防御」，护盾激活时播放黑色粒子效果，护盾值为0后5秒重新激活。
3. 深渊巨兽（混沌裂隙核心2层）：等级9，生命值1200，攻击力90，防御力40，技能：深渊咆哮（全屏减速30%，持续3秒）、巨兽践踏（范围伤害=攻击力×2.0），掉落：混沌核心×2+混沌碎片×8，掉落概率100%；实现逻辑：创建巨型怪兽模型，AI为「缓慢追击+技能爆发」，深渊咆哮释放时播放声波粒子，巨兽践踏时地面生成震动效果（CSS屏幕轻微晃动）。
4. 混沌领主分身（混沌裂隙核心3层）：等级9，生命值1500，攻击力100，防御力45，技能：混沌风暴（持续5秒，每秒造成攻击力×0.8范围伤害）、瞬移（随机移动到玩家周围5m内），掉落：混沌核心×3+混沌碎片×10，掉落概率100%；实现逻辑：创建混沌领主缩小版模型，AI为「技能循环+瞬移突袭」，混沌风暴释放时生成大范围黑色粒子，瞬移时播放消失-出现动画。
5. 混沌领主（混沌裂隙核心顶层）：等级10，生命值2000，攻击力120，防御力50，技能：混沌毁灭（全屏伤害=攻击力×3.0，冷却10秒）、黑暗诅咒（玩家施法速度降低20%，持续5秒）、生命汲取（每5秒汲取玩家50点生命值），掉落：终极魔杖（对应专精）+混沌核心×5，掉落概率100%；实现逻辑：创建巨型混沌领主模型，AI为「多技能循环+高频攻击」，技能释放时播放震撼粒子效果（如全屏黑暗渐变），生命汲取时生成黑色粒子流从玩家指向BOSS。
 
五、场景设定（共5个，无遗漏）
 
1. 星陨之塔大厅（初始场景）：面积100㎡，包含NPC（院长、导师）、任务面板、存档石碑，无魔兽；实现逻辑：Three.js加载大厅3D模型（地面、墙壁、桌椅），设置可交互物体碰撞检测，通过CSS固定UI面板（任务、存档）位置，场景光照采用环境光+点光源模拟魔法灯光。
2. 火焰峡谷（火焰试炼场）：面积500㎡，地形为岩石+熔岩，包含普通魔兽（火焰幼兽）、精英魔兽（火焰领主）、宝箱（随机掉落火焰结晶）；实现逻辑：加载峡谷地形模型，通过粒子系统模拟熔岩火焰效果，地面添加熔岩纹理，设置地形碰撞（不可穿过岩石），宝箱设置随机刷新位置（每次进入场景刷新1个）。
3. 冰霜冻土（冰霜试炼场）：面积500㎡，地形为冰雪+冰川，包含普通魔兽（冰霜蠕虫）、精英魔兽（冰霜女王）、宝箱（随机掉落冰霜结晶）；实现逻辑：加载冻土地形模型，添加冰雪纹理，通过粒子系统模拟雪花飘落，冰川区域设置滑行效果（移动速度提升10%），宝箱刷新规则同火焰峡谷。
4. 雷电高原（雷电试炼场）：面积500㎡，地形为高原+雷电云，包含普通魔兽（雷电蝙蝠）、精英魔兽（雷电使者）、宝箱（随机掉落雷电结晶）；实现逻辑：加载高原地形模型，添加云层粒子（悬浮于空中），通过粒子系统模拟雷电闪烁（随机触发），雷电区域（地面紫色纹理）触发玩家轻微伤害（每秒5点），宝箱刷新规则同上。
5. 混沌裂隙（终局场景）：分为外围、核心1-3层、顶层，总面积1000㎡，地形为黑暗岩石+混沌雾气，包含所有普通/精英/BOSS魔兽，无宝箱；实现逻辑：加载裂隙地形模型，通过粒子系统模拟混沌雾气（透明度渐变），场景光照变暗（仅点光源模拟怪物眼睛发光），每层通过传送门（碰撞检测触发场景切换）衔接，顶层设置巨型BOSS平台（无其他障碍物）。
 
六、任务设定（共14个，无遗漏）
 
（一）主线任务（8个，按等级解锁）
 
1. 新生报到（1级解锁）：触发条件：初始进入大厅，与院长对话；任务目标：与3位导师（火焰/冰霜/雷电/自然）分别对话；奖励：100经验值+基础魔杖；实现逻辑：通过NPC对话状态判断任务进度，所有导师对话完成后，自动发放奖励并解锁下一个主线任务。
2. 元素启蒙（1级解锁）：触发条件：完成「新生报到」；任务目标：选择1个元素专精，学习对应1级咒语；奖励：200经验值+对应元素结晶×5；实现逻辑：检测玩家专精选择状态和咒语学习状态，两者均完成后发放奖励，解锁下一个主线任务。
3. 初次试炼（2级解锁）：触发条件：完成「元素启蒙」且等级≥2；任务目标：击杀5只对应元素试炼场的普通魔兽；奖励：300经验值+100金币；实现逻辑：通过计数器记录对应魔兽击杀数量，达到5只后发放奖励，解锁下一个主线任务。
4. 结晶收集（3级解锁）：触发条件：完成「初次试炼」且等级≥3；任务目标：收集10个对应元素结晶；奖励：400经验值+对应元素3级咒语；实现逻辑：检测玩家背包中对应结晶数量，达到10个后发放奖励，解锁咒语（UI面板中显示）。
5. 精英挑战（6级解锁）：触发条件：完成「结晶收集」且等级≥6；任务目标：击杀对应元素试炼场的精英魔兽；奖励：800经验值+高级元素结晶×5+对应元素5级咒语；实现逻辑：检测对应精英魔兽击杀状态（仅需1只），击杀后发放奖励，解锁咒语。
6. 裂隙初探（7级解锁）：触发条件：完成「精英挑战」且等级≥7；任务目标：进入混沌裂隙外围，击杀10只普通魔兽；奖励：1000经验值+混沌碎片×10+对应元素7级咒语；实现逻辑：记录裂隙外围魔兽击杀数量，达到10只后发放奖励，解锁咒语。
7. 核心攻坚（9级解锁）：触发条件：完成「裂隙初探」且等级≥9；任务目标：击杀混沌裂隙核心1-2层的BOSS（混沌骑士、暗影法师、深渊巨兽）；奖励：2000经验值+混沌核心×3+对应元素9级咒语；实现逻辑：检测3只BOSS击杀状态，全部击杀后发放奖励，解锁终极咒语。
8. 终极封印（10级解锁）：触发条件：完成「核心攻坚」且等级≥10；任务目标：击杀混沌裂隙顶层的混沌领主；奖励：游戏通关+「最强魔法师」称号+终极魔杖；实现逻辑：检测混沌领主击杀状态，击杀后播放通关动画，更新角色称号和装备，游戏结束（可重新开始）。
 
（二）支线任务（4个，按等级解锁）
 
1. 魔杖强化（4级解锁）：触发条件：等级≥4；任务目标：收集5个混沌碎片；奖励：当前装备魔杖伤害提升5%；实现逻辑：检测背包中混沌碎片数量，达到5个后发放奖励（修改魔杖属性），任务不可重复。
2. 法袍解锁（8级解锁）：触发条件：等级≥8；任务目标：击杀对应元素精英魔兽2次；奖励：对应专精专属法袍；实现逻辑：记录对应精英魔兽击杀次数，达到2次后发放奖励（解锁UI面板中法袍切换功能），任务不可重复。
3. 魔法补给（5级解锁）：触发条件：等级≥5；任务目标：与学院大厅的药剂师对话；奖励：生命药剂×5（每瓶恢复30点生命值）+魔法药剂×5（每瓶恢复20点魔法值）；实现逻辑：检测与药剂师对话状态，对话后发放道具（添加到背包UI），任务不可重复。
4. 远古知识（7级解锁）：触发条件：等级≥7；任务目标：阅读4个元素试炼场的远古石碑（每个试炼场1个）；奖励：所有属性+5点；实现逻辑：通过碰撞检测记录石碑阅读状态，4个全部阅读后发放属性奖励（修改角色属性数值），任务不可重复。
 
（三）每日任务（2个，无限重复）
 
1. 试炼修炼（1级解锁）：触发条件：每日可接1次（按本地时间0点刷新）；任务目标：击杀10只任意普通魔兽；奖励：50经验值+20金币；实现逻辑：通过本地时间判断任务是否可接，击杀数量达到10只后发放奖励，次日刷新任务状态。
2. 碎片收集（4级解锁）：触发条件：等级≥4，每日可接1次；任务目标：收集3个混沌碎片；奖励：80经验值+生命药剂×2；实现逻辑：本地时间刷新任务，碎片数量达标后发放奖励，可重复完成。
 
七、装备设定（共3类，16件，无遗漏）
 
（一）魔杖（5件，无额外）
 
1. 基础魔杖（初始获取）：属性：无加成；实现逻辑：角色初始装备，UI面板中默认显示，不可卸下。
2. 火焰魔杖（5级解锁）：属性：火焰咒语伤害+10%；获取方式：完成「元素启蒙」任务；实现逻辑：任务奖励发放后，自动替换基础魔杖，UI面板更新显示，属性加成实时生效。
3. 冰霜魔杖（5级解锁）：属性：冰霜咒语伤害+10%；获取方式：完成「元素启蒙」任务；实现逻辑：同上。
4. 雷电魔杖（5级解锁）：属性：雷电咒语伤害+10%；获取方式：完成「元素启蒙」任务；实现逻辑：同上。
5. 终极魔杖（10级解锁）：属性：对应专精咒语伤害+20%、施法速度+0.2倍；获取方式：完成「终极封印」任务；实现逻辑：通关后自动替换当前魔杖，属性叠加（与专精魔杖加成叠加，总伤害+30%）。
 
（二）法袍（5件，无额外）
 
1. 基础制服（初始获取）：属性：无加成；实现逻辑：初始外观，UI面板默认显示，不可卸下。
2. 火焰法袍（8级解锁）：属性：无加成（仅外观）；获取方式：完成「法袍解锁」支线任务；实现逻辑：任务完成后，UI面板解锁切换功能，切换后通过Three.js替换角色服装模型。
3. 冰霜法袍（8级解锁）：属性：无加成（仅外观）；获取方式：完成「法袍解锁」支线任务；实现逻辑：同上。
4. 雷电法袍（8级解锁）：属性：无加成（仅外观）；获取方式：完成「法袍解锁」支线任务；实现逻辑：同上。
5. 自然法袍（8级解锁）：属性：无加成（仅外观）；获取方式：完成「法袍解锁」支线任务；实现逻辑：同上。
 
（三）饰品（6件，无额外）
 
1. 生命项链（3级解锁）：属性：生命值+30点；获取方式：火焰峡谷宝箱随机掉落；实现逻辑：宝箱打开后添加到背包，UI面板可装备，装备后立即增加生命值。
2. 魔法项链（3级解锁）：属性：魔法值+25点；获取方式：冰霜冻土宝箱随机掉落；实现逻辑：同上。
3. 攻击戒指（4级解锁）：属性：攻击力+8点；获取方式：雷电高原宝箱随机掉落；实现逻辑：同上。
4. 防御戒指（4级解锁）：属性：防御力+5点；获取方式：自然森林宝箱随机掉落；实现逻辑：同上。
5. 施法披风（6级解锁）：属性：施法速度+0.1倍；获取方式：击杀任意精英魔兽掉落；实现逻辑：精英魔兽击杀后自动添加到背包，装备后生效。
6. 混沌护身符（9级解锁）：属性：所有属性+10点；获取方式：击杀深渊巨兽掉落；实现逻辑：BOSS击杀后自动添加到背包，装备后所有属性数值增加10点。
 
八、交互系统设定（共3类，无遗漏）
 
（一）NPC交互（6个NPC，无额外）
 
1. 院长（大厅）：功能：发放主线任务「新生报到」、提供游戏背景介绍；实现逻辑：靠近后触发对话UI（CSS创建对话框，显示文字内容），对话分多段，点击「下一段」推进，完成后更新任务状态。
2. 火焰导师（大厅）：功能：讲解火焰魔法知识、玩家选择火焰专精后解锁火焰咒语；实现逻辑：对话UI中提供专精选择按钮（仅1级时显示），选择后解锁对应咒语，后续对话仅提供知识讲解。
3. 冰霜导师（大厅）：功能：讲解冰霜魔法知识、玩家选择冰霜专精后解锁冰霜咒语；实现逻辑：同上。
4. 雷电导师（大厅）：功能：讲解雷电魔法知识、玩家选择雷电专精后解锁雷电咒语；实现逻辑：同上。
5. 自然导师（大厅）：功能：讲解自然魔法知识、玩家选择自然专精后解锁自然咒语；实现逻辑：同上。
6. 药剂师（大厅）：功能：发放支线任务「魔法补给」、提供药剂购买（生命药剂10金币/瓶，魔法药剂8金币/瓶）；实现逻辑：对话UI中显示任务按钮和购买按钮，购买时扣除金币并添加药剂到背包（金币不足时提示）。
 
（二）物体交互（4种，无额外）
 
1. 书架（大厅）：功能：提供魔法知识文本阅读；实现逻辑：靠近后触发阅读UI（显示文本内容），点击「关闭」退出，无其他奖励。
2. 任务面板（大厅）：功能：查看已接/未接任务、任务目标和奖励；实现逻辑：CSS创建固定面板，点击后展开，显示所有任务状态（已完成/进行中/未解锁），点击任务可查看详情。
3. 存档石碑（大厅）：功能：手动存档；实现逻辑：靠近后触发存档提示，点击「确认存档」后，将当前所有游戏数据存储到localStorage，存档成功后显示提示信息。
4. 宝箱（元素试炼场）：功能：获取道具（结晶、饰品）；实现逻辑：靠近后触发打开动画（Three.js播放宝箱开启模型动画），打开后随机发放1件对应道具，添加到背包，宝箱打开后消失（下次进入场景刷新）。
 
（三）战斗交互（3种，无额外）
 
1. 玩家攻击（物理/咒语）：实现逻辑：物理攻击通过射线检测命中魔兽后计算伤害，咒语攻击通过粒子模型碰撞检测或区域检测计算伤害，魔兽生命值减少到0时播放死亡动画（模型消失+粒子效果），并发放掉落物品。
2. 魔兽攻击：实现逻辑：魔兽AI检测到玩家后触发攻击，通过碰撞检测判断是否命中，命中后玩家生命值减少，播放受伤动画，生命值减少到0时触发游戏失败（显示失败UI，可选择重新开始）。
3. 技能交互（buff/debuff）：实现逻辑：玩家或魔兽释放技能后，为目标添加对应buff/debuff（通过属性标记和定时器实现），效果持续时间结束后清除标记，恢复原有属性。
 
九、UI系统设定（共6个面板，无额外）
 
1. 主界面UI：位置：屏幕底部/顶部；功能：显示生命值（红色进度条）、魔法值（蓝色进度条）、等级、金币数量、当前选中咒语图标；实现逻辑：CSS固定定位布局，通过JavaScript实时更新进度条宽度（根据当前/最大生命值/魔法值计算）和数值显示。
2. 属性面板：位置：屏幕右侧（默认隐藏，按C键展开）；功能：显示等级、经验值（进度条）、6项属性数值、当前装备；实现逻辑：CSS创建隐藏面板，监听C键事件控制显示/隐藏，数据实时同步角色属性。
3. 咒语面板：位置：屏幕左侧（默认隐藏，按V键展开）；功能：显示已学习咒语（图标+名称+消耗魔法值+冷却时间），点击选中咒语；实现逻辑：隐藏面板+V键控制，咒语图标按学习顺序排列，冷却时间通过倒计时数字和进度条显示，冷却期间不可选中。
4. 任务面板：位置：屏幕右侧（默认隐藏，按Q键展开）；功能：显示所有任务（主线/支线/每日），区分已完成/进行中/未解锁状态；实现逻辑：隐藏面板+Q键控制，任务状态通过文字颜色区分（绿色=已完成，黄色=进行中，灰色=未解锁），点击任务显示详情。
5. 战斗面板：位置：屏幕中央（战斗时显示）；功能：显示魔兽生命值（红色进度条）、名称、等级；实现逻辑：魔兽进入攻击范围后显示，离开范围后隐藏，进度条实时更新魔兽生命值。
6. 加载面板：位置：屏幕中央（游戏启动时显示）；功能：显示加载进度（0%-100%）；实现逻辑：Three.js加载场景模型、纹理、粒子资源时，计算加载进度并显示，加载完成后自动隐藏面板，进入游戏主界面。
 
十、存档与结局设定（共3点，无额外）
 
1. 存档机制：自动存档（关闭浏览器、完成任务、升级、获取关键装备时触发）、手动存档（通过存档石碑触发）；实现逻辑：所有游戏数据（角色属性、咒语、装备、任务、场景位置）存储在localStorage，格式为JSON字符串，加载时解析JSON并还原游戏状态。
2. 结局条件（仅1个结局）：完成主线任务「终极封印」，击杀混沌领主；实现逻辑：检测混沌领主击杀状态为true后，播放通关动画（混沌裂隙封印+角色站在塔顶的CG），显示结局文本（「你成为了埃瑟里亚大陆最强大的魔法师，成功守护了世界！」），解锁「最强魔法师」称号。
3. 游戏失败处理：玩家生命值减少到0时触发；实现逻辑：显示失败UI（「挑战失败」文本+「重新开始」按钮），点击重新开始后，加载最近一次存档数据（自动/手动存档），恢复游戏状态。
 
十一、技术实现核心逻辑（共4点，无额外）
 
1. 3D场景与模型：使用Three.js加载GLB/GLTF格式的角色、魔兽、场景模型，通过OrbitControls实现相机控制（玩家视角跟随角色移动），光照系统采用环境光+点光源+方向光模拟真实光影。
2. 动画系统：角色/魔兽动作（移动、攻击、施法、死亡）通过Three.js的AnimationMixer播放关键帧动画，粒子效果（火焰、冰霜、雷电、自然）通过Points类+BufferGeometry生成，添加纹理和透明度渐变实现。
3. 碰撞检测：采用Three.js的Raycaster（射线检测）实现点到点碰撞（如物理攻击、咒语命中），使用SphereGeometry（球形碰撞体）+BoxGeometry（长方体碰撞体）实现区域碰撞（如结界、技能范围）。
4. 数据存储与交互：通过localStorage存储游戏数据，JavaScript监听键盘/鼠标事件实现玩家操作，CSS实现UI布局和样式，所有模块通过事件总线（EventEmitter）实现数据通信（如角色属性更新触发UI更新）。
