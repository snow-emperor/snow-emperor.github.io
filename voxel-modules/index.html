<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <title>沙盒 2.0</title>
  <link rel="stylesheet" href="css/main.css"/>
  <link rel="icon" href="favicon.ico"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
</head>
<body>
<div id="ui-container">
  <div id="main-menu" class="panel">
    <h1>原子级沙盒 2.0</h1>
    <div class="menu-buttons">
      <button id="btn-new" class="menu-btn">新建世界</button>
      <button id="btn-continue" class="menu-btn">继续游戏</button>
      <button id="btn-load" class="menu-btn">加载存档</button>
      <button id="btn-settings" class="menu-btn">游戏设置</button>
      <button id="btn-help" class="menu-btn">帮助说明</button>
    </div>
    <div id="error-message" style="color: red; margin-top: 10px; display: none;"></div>
  </div>
  <div id="create-panel" class="panel hidden">
    <h2>创建世界</h2>
    <div class="form-group">
      <label>世界名称 <input id="world-name" value="新世界" placeholder="输入世界名称"/></label>
    </div>
    <div class="form-group">
      <label>种子 <input id="world-seed" type="number" value="12345" placeholder="输入世界种子"/></label>
    </div>
    <div class="form-group">
      <label>模式
        <select id="world-mode">
          <option value="creative">创造模式</option>
          <option value="survival">生存模式</option>
          <option value="adventure">冒险模式</option>
        </select>
      </label>
    </div>
    <div class="form-group">
      <label>难度
        <select id="world-difficulty">
          <option value="peaceful">和平</option>
          <option value="easy">简单</option>
          <option value="normal" selected>普通</option>
          <option value="hard">困难</option>
        </select>
      </label>
    </div>
    <div class="form-buttons">
      <button id="btn-create" class="action-btn">生成世界</button>
      <button id="btn-back" class="action-btn">返回</button>
    </div>
    <div id="create-error-message" style="color: red; margin-top: 10px; display: none;"></div>
  </div>
  <!-- 添加加载面板 -->
  <div id="loading-panel" class="panel hidden">
    <h2>正在生成世界...</h2>
    <div class="loading-spinner"></div>
    <p id="loading-text">准备生成世界</p>
  </div>
  <div id="settings-panel" class="panel hidden">
    <h2>游戏设置</h2>
    <div class="settings-group">
      <label><input type="checkbox" id="setting-particles" checked> 启用粒子效果</label>
      <label><input type="checkbox" id="setting-sound" checked> 启用音效</label>
      <label><input type="checkbox" id="setting-clouds" checked> 启用云彩效果</label>
      <label><input type="checkbox" id="setting-vsync" checked> 垂直同步</label>
    </div>
    <div class="form-buttons">
      <button id="btn-save-settings" class="action-btn">保存设置</button>
      <button id="btn-close-settings" class="action-btn">关闭</button>
    </div>
  </div>
  <div id="help-panel" class="panel hidden">
    <h2>帮助说明</h2>
    <div class="help-content">
      <h3>基本操作</h3>
      <ul>
        <li>WASD - 移动</li>
        <li>鼠标 - 转向</li>
        <li>鼠标左键 - 破坏物体</li>
        <li>鼠标右键 - 放置物体</li>
        <li>空格 - 跳跃</li>
        <li>Shift - 下蹲</li>
      </ul>
      <h3>游戏模式</h3>
      <ul>
        <li>创造模式 - 无限资源，飞行，瞬间破坏</li>
        <li>生存模式 - 血量、饥饿、辐射，挖矿耗时</li>
        <li>冒险模式 - 仅可与特定物体交互</li>
      </ul>
      <h3>特殊机制</h3>
      <ul>
        <li>核反应 - 铀等元素可触发裂变</li>
        <li>化学反应 - 某些元素组合可产生新元素</li>
        <li>稀有矿物 - 深层可找到钻石、红宝石等稀有物品</li>
      </ul>
    </div>
    <button id="btn-close-help" class="action-btn">关闭</button>
  </div>
  <div id="save-load-panel" class="panel hidden">
    <h2>存档管理</h2>
    <div class="save-section">
      <h3>保存游戏</h3>
      <div class="form-group">
        <label>存档名称 <input id="save-name" value="我的存档" placeholder="输入存档名称"/></label>
      </div>
      <button id="btn-save-game" class="action-btn">保存游戏</button>
      <!-- 添加导出存档按钮 -->
      <button id="btn-export-save" class="action-btn">导出存档到文件</button>
    </div>
    <div class="load-section">
      <h3>加载存档</h3>
      <input type="file" id="save-file-input" accept=".json" style="display: none;">
      <button id="btn-browse-saves" class="menu-btn">浏览存档文件</button>
      <div id="save-list"></div>
    </div>
    <button id="btn-close-save-panel" class="action-btn">返回</button>
  </div>
  <div id="hud" class="hidden">
    <div id="hud-left">
      <div id="hp">❤ 20</div>
      <div id="food">🍖 20</div>
      <div id="rad">☢ 0</div>
      <div id="energy">⚡ 100</div>
    </div>
    <div id="hud-right">
      <div id="coords">0 0 0</div>
      <div id="mode">生存</div>
      <div id="fps">FPS: 60</div>
    </div>
    <div id="hotbar"></div>
    <div id="save-indicator" style="position: absolute; top: 10px; width: 100%; text-align: center; display: none; color: #4CAF50;">
      存档已保存!
    </div>
  </div>
</div>
<script>
  // 添加调试信息
  console.log('开始加载主模块');
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM加载完成');
  });
</script>
<script>
  // 延迟加载主模块，确保所有资源准备就绪
  setTimeout(() => {
    const script = document.createElement('script');
    script.type = 'module';
    script.src = './js/main.js';
    script.onerror = function(e) {
      console.error('加载主模块失败:', e);
      const errorMsg = document.getElementById('error-message');
      if (errorMsg) {
        errorMsg.textContent = '加载游戏失败，请检查网络连接或浏览器兼容性';
        errorMsg.style.display = 'block';
      }
    };
    document.head.appendChild(script);
  }, 100);
</script>
</body>
</html>

